<html>
<head>
    <style>
        .gameFrame {
            width: 640px;
            height: 360px;
            background: red;
            position: relative;
        }

        .gameFrame iframe {
            left: 0;
            width: 1280px;
            height: 720px;
            transform: scale(0.5,0.5);
            -webkit-transform: scale(0.5, 0.5) translate(-640px,-360px);
        }
    </style>
    <script src="../../bower_components/jquery/jquery.js"></script>
    <script src="/scripts/GameController.js"></script>
</head>
    <body>
    <div class="gameFrame"><iframe id="level1" src="TestLevel.html"></iframe></div>
    <div class="gameFrame"><iframe id="level2" src="TestLevel.html"></iframe></div>
    </body>

    <script>
        // TODO: use robust way to understand when animations/levels are loaded
        setTimeout(function(){
            var g1 = new GameController(document.getElementById('level1'))
            var g2 = new GameController(document.getElementById('level2'))
            g1.onTriggerEvent = function(e) {
                g1.triggerEvent(e);
                g2.triggerEvent(e);
//                console.log("trigger event", e);
            };
            g2.onOtherMouseMove = function(event) {
                var elem = g2.otherPlayers[event.playerId].cursorElem;
                $(elem).offset({left:event.args[0].pageX, top:event.args[0].pageY});
            };

            g2.onOtherPlayerAdd = function(player) {
                var e = $(g2.overlayElement);
                player.cursorElem = $("<div class='cursor'></div>");
                e.append(player.cursorElem);
            };
            g2.onOtherPlayerRemove = function(player) {
                var elem = player.cursorElem;
                elem.remove();
                delete player.cursorElem;
            };

            // debugging
            window.g1 = g1;
            window.g2 = g2;
        }, 300);

    </script>
</html>